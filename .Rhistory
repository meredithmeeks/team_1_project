summary(glm((partyid == "Independent near Democrat") ~ adults + as.factor(race) + as.factor(relig == 1) + as.factor(sex) + age + rincom06 + as.factor(sex):rincom06 + union + child1 + child2 + child3more, family = binomial(link = "logit"), data = gss, subset = gss$partyid != "Strong Democrat" | gss$partyid != "Not Strong Democrat")))
summary(glm((partyid == "Independent near Democrat") ~ adults + as.factor(race) + as.factor(relig == 1) + as.factor(sex) + age + rincom06 + as.factor(sex):rincom06 + union + child1 + child2 + child3more, family = binomial(link = "logit"), data = gss, subset = gss$partyid != "Strong Democrat"))
ggplot(gss, aes(x = partyid, y = age)) + geom_jitter((aes(color=sex))) + facet_wrap(~ race) + ggtitle("Relationship between Age and PartyID, separating by Sex and Race") + labs(x="Political Party Affiliation", y="Age")
#relig, relig16, adults
#relig
gss_2006$notstrongdem <- ifelse(gss_2006$partyid==1, 1, 0)
#relig, relig16, adults
#relig
gss$notstrongdem <- ifelse(gss$partyid==1, 1, 0)
gg_relig <- ggplot(gss, aes(relig)) + geom_bar(aes(fill=as.factor(gss_2006$partyid)))
#blue - weak democrat
gg_relig_2 <- ggplot(gss, aes(relig)) + geom_bar(aes(fill=as.factor(gss_2006$notstrongdem)))
gg_relig_3 <- ggplot(gss, aes(x=relig, y=notstrongdem, color=as.factor(sex))) + geom_jitter()
#relig16
gg_relig16 <- ggplot(gss, aes(relig16)) + geom_bar(aes(fill=as.factor(gss_2006$partyid)))
#blue - weak democrat
gg_relig16_2 <- ggplot(gss, aes(relig16)) + geom_bar(aes(fill=as.factor(gss_2006$notstrongdem)))
gg_relig16_3 <- ggplot(gss, aes(x=relig16, y=notstrongdem, color=as.factor(sex))) + geom_jitter()
#adults
gg_adult <- ggplot(gss, aes(adults)) + geom_bar(aes(fill=as.factor(gss_2006$partyid)))
#blue - weak democrat
gg_adult_2 <- ggplot(gss, aes(adults)) + geom_bar(aes(fill=as.factor(gss_2006$notstrongdem)))
gg_adult_3 <- ggplot(gss, aes(x=adults, y=notstrongdem, color=as.factor(sex))) + geom_jitter()
gg_adult_4 <- ggplot(gss, aes(x=adults, y=notstrongdem, color=as.factor(race))) + geom_jitter()
knitr::opts_chunk$set(echo = TRUE)
gss <- read.csv("Data/GSS.2006.csv") # team_1_project/Data
partynames <- c("Strong Democrat", "Not Strong Democrat", "Independent near Democrat",
"Independent", "Independent near Republican", "Not Strong Republican",
"Strong Republican", "Other")
gss$partyid <- as.factor(gss$partyid)
levels(gss$partyid) <- partynames
gss$child1 <- ifelse(gss$childs==1, 1, 0)
gss$child2 <- ifelse(gss$childs==2, 1, 0)
gss$child3more <- ifelse(gss$childs>=3, 1, 0)
gss$region <- as.factor(gss$region)
gss <- within(gss, region <- relevel(region, ref = 3))
gss$relig <- as.factor(gss$relig)
gss <- within(gss, relig <- relevel(relig, ref = 4))
summary(glm((partyid == "Independent") ~ adults + as.factor(race) + as.factor(relig == 4) + as.factor(sex) + age + rincom06 + as.factor(sex):rincom06 + union + child1 + child2 + child3more, family = binomial(link = "logit"), data = gss))
gss$sex <- as.factor(gss$sex)
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ race + (relig == 4) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + wrkstat == 5 + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkstat == 5) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkstat == 1) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkstat == 5) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 1) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + sex + age + rincom06 + sex:rincom06 + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + sex + age + rincom06 + sex:rincom06 + prest80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + sex + age + rincom06 + sex:rincom06 + prestg80 + educ + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
table(gss$born, gss$(reg16 == 0))
table(gss$born, gss$reg16 == 0)
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (reg16 == 0) + born + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (reg16 == 0) + born + (reg16 == 0):born + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + born + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, data = gss))
if (!require("dplyr")) {
install.packages("dplyr", dependencies = TRUE)
library(dplyr) }
if (!require("tidyr")) {
install.packages("tidyr", dependencies = TRUE)
library(tidyr) }
if (!require("readr")) {
install.packages("readr", dependencies = TRUE)
library(readr) }
if (!require("ggplot2")) {
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2) }
if (!require("ggthemes")) {
install.packages("ggthemes", dependencies = TRUE)
library(ggthemes) }
if (!require("bartMachine")) {
install.packages("bartMachine", dependencies = TRUE)
library(bartMachine) }
gss <- read.csv("Data/GSS.2006.csv") # team_1_project/Data
partynames <- c("Strong Democrat", "Not Strong Democrat", "Independent near Democrat",
"Independent", "Independent near Republican", "Not Strong Republican",
"Strong Republican", "Other")
gss$partyid <- as.factor(gss$partyid)
levels(gss$partyid) <- partynames
gss$child1 <- ifelse(gss$childs==1, 1, 0)
gss$child2 <- ifelse(gss$childs==2, 1, 0)
gss$child3more <- ifelse(gss$childs>=3, 1, 0)
gss$region <- as.factor(gss$region)
gss <- within(gss, region <- relevel(region, ref = 3))
gss$relig <- as.factor(gss$relig)
gss <- within(gss, relig <- relevel(relig, ref = 4))
gss$sex <- as.factor(gss$sex)
gss$race <- as.factor(gss$race)
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, data = gss))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race == 1) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = gss$partyid != "Strong Republican"))
summary(glm((partyid == "Independent near Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Republican", "Not Strong Republican"))))
summary(glm((partyid == "Not Strong Republican") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (wrkgovt == 2) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (relig == 1) + (relig == 3) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
knitr::opts_chunk$set(echo = TRUE)
if (!require("dplyr")) {
install.packages("dplyr", dependencies = TRUE)
library(dplyr) }
if (!require("tidyr")) {
install.packages("tidyr", dependencies = TRUE)
library(tidyr) }
if (!require("readr")) {
install.packages("readr", dependencies = TRUE)
library(readr) }
if (!require("ggplot2")) {
install.packages("ggplot2", dependencies = TRUE)
library(ggplot2) }
if (!require("ggthemes")) {
install.packages("ggthemes", dependencies = TRUE)
library(ggthemes) }
if (!require("bartMachine")) {
install.packages("bartMachine", dependencies = TRUE)
library(bartMachine) }
gss <- read.csv("Data/GSS.2006.csv") # team_1_project/Data
partynames <- c("Strong Democrat", "Not Strong Democrat", "Independent near Democrat",
"Independent", "Independent near Republican", "Not Strong Republican",
"Strong Republican", "Other")
gss$partyid <- as.factor(gss$partyid)
levels(gss$partyid) <- partynames
gss$child1 <- ifelse(gss$childs==1, 1, 0)
gss$child2 <- ifelse(gss$childs==2, 1, 0)
gss$child3more <- ifelse(gss$childs>=3, 1, 0)
gss$region <- as.factor(gss$region)
gss <- within(gss, region <- relevel(region, ref = 3))
gss$relig <- as.factor(gss$relig)
gss <- within(gss, relig <- relevel(relig, ref = 4))
gss$sex <- as.factor(gss$sex)
gss$race <- as.factor(gss$race)
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + as.factor(relig) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + (born == 2 | reg16 == 0) + sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) + marital + adults + child1 + child2 + child3more + union, family = binomial(link = "logit"), data = gss, subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
class(gss$relig)
table(gss$relig)
sum(gss$relig == 1)
sum(gss$relig == '1')
sum(gss$relig == 'Catholic')
relig <- na.omit(gss$relig)
sum(relig == '1')
sum(relig == 1)
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = (gss$relig %in% c(1, 2))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = (gss$partyid %in% c("Strong Democrat", "Not Strong Democrat", "Independent near Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 2) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = (gss$partyid %in% c("Strong Democrat", "Not Strong Democrat", "Independent near Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + union,
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + as.factor(union),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 2) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
marital + adults + child1 + child2 + child3more + union,
family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 1) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + #(relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat") & gss$relig == 1)))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + #(relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat") & gss$relig > 1)))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + #(relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat") & gss$relig > 2)))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + #(relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat") & gss$relig != 1)))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + #(relig == 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat") & gss$relig != 2)))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
age:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
age:rincom06 +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + age:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06  + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + child2 + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig == 4) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child3more + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
1
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1) + #(born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1 | 2) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ as.factor(race) + (relig != 1 & 2) + (born == 2 | reg16 == 0) +
sex + age + rincom06 + sex:rincom06 + prestg80 + degree + degree:as.factor(race) +
degree:age + age:sex + marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(gss$sex)
summary(child1)
summary(gss$child1)
table(gss$child1)
gss$isblack <- ifelse(gss$race == 2, 1, 0)
gss$isfemale <- ifelse(gss$sex == 2, 1, 0)
dem_glm <- glm((partyid == "Independent near Democrat") ~ isblack + (relig != 1) + (relig != 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale +
rincom06 + isfemale:rincom06 +
prestg80 +
degree + degree:isblack + degree:age +
marital + adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat")))
dem_glm <- glm((partyid == "Independent near Democrat") ~ isblack + (relig != 1) + (relig != 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack + degree:age + degree:isfemale +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat")))
summary(dem_glm)
step_dem_glm <- step(dem_glm, direction = 'both', trace = F)
dem_glm <- glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack + degree:age + degree:isfemale +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat")))
summary(dem_glm)
step_dem_glm <- step(dem_glm, direction = 'both', trace = F)
dem_glm <- glm((partyid == "Independent near Democrat") ~ isblack + #(relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack + degree:age + degree:isfemale +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat")))
step_dem_glm <- step(dem_glm, direction = 'both', trace = F)
step_dem_glm <- step(dem_glm, direction = 'both', trace = F, object = 'glm')
step_dem_glm <- step(dem_glm, direction = 'both', trace = F, object = 'glm')
dem_glm <- glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack + degree:age + degree:isfemale +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat")))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack + degree:age + degree:isfemale +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + age:isblack + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | 2) + #(relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) + #(relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) + (relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age + age:isfemale + isblack:isfemale +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital + marital:isfemale +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital +
adults + child1 + (union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital +
adults + child1 + adults:child1 +
(union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
class(gss$child1)
summary(glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital +
adults + as.factor(child1) + adults:as.factor(child1) +
(union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
dem_glm1 <- (glm((partyid == "Independent near Democrat") ~ isblack + (relig == 1 | relig == 2) +
(born == 2 | reg16 == 0) +
isfemale + age +
rincom06 + isfemale:rincom06 + age:rincom06 + isblack:rincom06 +
prestg80 +
degree + degree:isblack +
marital +
adults + as.factor(child1) + adults:as.factor(child1) +
(union == 4),
family = binomial(link = "logit"), data = gss,
subset = !(gss$partyid %in% c("Strong Democrat", "Not Strong Democrat"))))
pred <- predict.glm(dem_glm1, newdata = gss, type = "response") > 0.5
true_val <- gss$partyid == "Independent near Democrat"
comparison <- true_val == pred
summary(comparison)
test <- subset(gss, partyid == "Independent near Democrat")
table(gss$partyid)
pred <- predict.glm(dem_glm1, newdata = test, type = "response") > 0.5
summary(pred)
pred <- predict.glm(dem_glm1, newdata = test, type = "response")
summary(pred)
pred <- predict.glm(republican, newdata = gss, type = "response") > 0.5
true_val <- gss$partyid == "Independent near Democrat"
pred <- predict.glm(dem_glm1, newdata = gss, type = "response") > 0.5
true_val <- gss$partyid == "Independent near Democrat"
comparison <- true_val == TRUE & pred == T
summary(comparison)
